import{r as m,D as se,H as ie,d as r,I as z,o as i,c as N,L as f,O as I,i as a,f as l,h as t,J as K,K as Q,m as g,l as de,p,F as A,e as O,A as pe,C as ce,x as me}from"./index-B5XNB-yB.js";import{l as fe,g as ge,u as _e,a as ye,d as ve}from"./category-BasmY3_F.js";const be={class:"app-container"},he={class:"dialog-footer"},we=ce({name:"Category"}),Se=Object.assign(we,{setup(Ce){const{proxy:c}=me(),{category_subject:k}=c.useDict("category_subject"),P=m([]),_=m(!1),S=m(!0),w=m(!0),x=m([]),q=m(!0),F=m(!0),D=m(0),U=m(""),H=se({form:{},queryParams:{pageNum:1,pageSize:10,type:null,name:null},rules:{name:[{required:!0,message:"分类名称不能为空",trigger:"blur"}]}}),{queryParams:u,form:s,rules:J}=ie(H);function y(){S.value=!0,fe(u.value).then(n=>{P.value=n.rows,D.value=n.total,S.value=!1})}function G(){_.value=!1,R()}function R(){s.value={id:null,type:null,name:null,sort:null,createTime:null,updateTime:null},c.resetForm("categoryRef")}function T(){u.value.pageNum=1,y()}function M(){c.resetForm("queryRef"),T()}function W(n){x.value=n.map(o=>o.id),q.value=n.length!=1,F.value=!n.length}function X(){R(),_.value=!0,U.value="添加菜品及套餐分类"}function B(n){R();const o=n.id||x.value;ge(o).then(C=>{s.value=C.data,_.value=!0,U.value="修改菜品及套餐分类"})}function Y(){c.$refs.categoryRef.validate(n=>{n&&(s.value.id!=null?_e(s.value).then(o=>{c.$modal.msgSuccess("修改成功"),_.value=!1,y()}):ye(s.value).then(o=>{c.$modal.msgSuccess("新增成功"),_.value=!1,y()}))})}function E(n){const o=n.id||x.value;c.$modal.confirm('是否确认删除菜品及套餐分类编号为"'+o+'"的数据项？').then(function(){return ve(o)}).then(()=>{y(),c.$modal.msgSuccess("删除成功")}).catch(()=>{})}function Z(){c.download("category/category/export",{...u.value},`category_${new Date().getTime()}.xlsx`)}return y(),(n,o)=>{const C=r("el-option"),L=r("el-select"),v=r("el-form-item"),$=r("el-input"),d=r("el-button"),j=r("el-form"),V=r("el-col"),ee=r("right-toolbar"),le=r("el-row"),b=r("el-table-column"),te=r("dict-tag"),ae=r("el-table"),oe=r("pagination"),ne=r("el-dialog"),h=z("hasPermi"),re=z("loading");return i(),N("div",be,[f(l(j,{model:a(u),ref:"queryRef",inline:!0,"label-width":"68px"},{default:t(()=>[l(v,{label:"分类类型",prop:"type"},{default:t(()=>[l(L,{modelValue:a(u).type,"onUpdate:modelValue":o[0]||(o[0]=e=>a(u).type=e),placeholder:"请选择分类类型",clearable:""},{default:t(()=>[(i(!0),N(K,null,Q(a(k),e=>(i(),g(C,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(v,{label:"分类名称",prop:"name"},{default:t(()=>[l($,{modelValue:a(u).name,"onUpdate:modelValue":o[1]||(o[1]=e=>a(u).name=e),placeholder:"请输入分类名称",clearable:"",onKeyup:de(T,["enter"])},null,8,["modelValue"])]),_:1}),l(v,null,{default:t(()=>[l(d,{type:"primary",icon:"Search",onClick:T},{default:t(()=>[p("搜索")]),_:1}),l(d,{icon:"Refresh",onClick:M},{default:t(()=>[p("重置")]),_:1})]),_:1})]),_:1},8,["model"]),[[I,a(w)]]),l(le,{gutter:10,class:"mb8"},{default:t(()=>[l(V,{span:1.5},{default:t(()=>[f((i(),g(d,{type:"primary",plain:"",icon:"Plus",onClick:X},{default:t(()=>[p("新增")]),_:1})),[[h,["category:category:add"]]])]),_:1}),l(V,{span:1.5},{default:t(()=>[f((i(),g(d,{type:"success",plain:"",icon:"Edit",disabled:a(q),onClick:B},{default:t(()=>[p("修改")]),_:1},8,["disabled"])),[[h,["category:category:edit"]]])]),_:1}),l(V,{span:1.5},{default:t(()=>[f((i(),g(d,{type:"danger",plain:"",icon:"Delete",disabled:a(F),onClick:E},{default:t(()=>[p("删除")]),_:1},8,["disabled"])),[[h,["category:category:remove"]]])]),_:1}),l(V,{span:1.5},{default:t(()=>[f((i(),g(d,{type:"warning",plain:"",icon:"Download",onClick:Z},{default:t(()=>[p("导出")]),_:1})),[[h,["category:category:export"]]])]),_:1}),l(ee,{showSearch:a(w),"onUpdate:showSearch":o[2]||(o[2]=e=>A(w)?w.value=e:null),onQueryTable:y},null,8,["showSearch"])]),_:1}),f((i(),g(ae,{data:a(P),onSelectionChange:W},{default:t(()=>[l(b,{type:"selection",width:"55",align:"center"}),l(b,{label:"分类类型",align:"center",prop:"type"},{default:t(e=>[l(te,{options:a(k),value:e.row.type},null,8,["options","value"])]),_:1}),l(b,{label:"分类名称",align:"center",prop:"name"}),l(b,{label:"顺序",align:"center",prop:"sort"}),l(b,{label:"更新时间",align:"center",prop:"updateTime",width:"180"},{default:t(e=>[O("span",null,pe(n.parseTime(e.row.updateTime,"{y}-{m}-{d} {h}:{i}:{s}")),1)]),_:1}),l(b,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:t(e=>[f((i(),g(d,{link:"",type:"primary",icon:"Edit",onClick:ue=>B(e.row)},{default:t(()=>[p("修改")]),_:2},1032,["onClick"])),[[h,["category:category:edit"]]]),f((i(),g(d,{link:"",type:"primary",icon:"Delete",onClick:ue=>E(e.row)},{default:t(()=>[p("删除")]),_:2},1032,["onClick"])),[[h,["category:category:remove"]]])]),_:1})]),_:1},8,["data"])),[[re,a(S)]]),f(l(oe,{total:a(D),page:a(u).pageNum,"onUpdate:page":o[3]||(o[3]=e=>a(u).pageNum=e),limit:a(u).pageSize,"onUpdate:limit":o[4]||(o[4]=e=>a(u).pageSize=e),onPagination:y},null,8,["total","page","limit"]),[[I,a(D)>0]]),l(ne,{title:a(U),modelValue:a(_),"onUpdate:modelValue":o[8]||(o[8]=e=>A(_)?_.value=e:null),width:"500px","append-to-body":""},{footer:t(()=>[O("div",he,[l(d,{type:"primary",onClick:Y},{default:t(()=>[p("确 定")]),_:1}),l(d,{onClick:G},{default:t(()=>[p("取 消")]),_:1})])]),default:t(()=>[l(j,{ref:"categoryRef",model:a(s),rules:a(J),"label-width":"80px"},{default:t(()=>[l(v,{label:"分类类型",prop:"type"},{default:t(()=>[l(L,{modelValue:a(s).type,"onUpdate:modelValue":o[5]||(o[5]=e=>a(s).type=e),placeholder:"请选择分类类型"},{default:t(()=>[(i(!0),N(K,null,Q(a(k),e=>(i(),g(C,{key:e.value,label:e.label,value:parseInt(e.value)},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(v,{label:"分类名称",prop:"name"},{default:t(()=>[l($,{modelValue:a(s).name,"onUpdate:modelValue":o[6]||(o[6]=e=>a(s).name=e),placeholder:"请输入分类名称"},null,8,["modelValue"])]),_:1}),l(v,{label:"顺序",prop:"sort"},{default:t(()=>[l($,{modelValue:a(s).sort,"onUpdate:modelValue":o[7]||(o[7]=e=>a(s).sort=e),placeholder:"请输入顺序"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{Se as default};
